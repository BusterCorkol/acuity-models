{
    "MetaData": {
        "Name": "qwen_2.5_7b_block0_prefill",
        "AcuityVersion": "6",
        "Platform": "tensorflow",
        "Org_Platform": "onnx"
    },
    "Layers": {
        "attach_logits/out0_0": {
            "name": "attach_logits/out0",
            "op": "output",
            "parameters": {},
            "inputs": [
                "@logits_3:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "attach_presents/out0_1": {
            "name": "attach_presents/out0",
            "op": "output",
            "parameters": {},
            "inputs": [
                "@presents_2:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "presents_2": {
            "name": "presents",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    2,
                    1,
                    256,
                    4,
                    128
                ]
            },
            "inputs": [
                "@Concat_2_output_0_4:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "logits_3": {
            "name": "logits",
            "op": "add",
            "inputs": [
                "@Add_3_output_0_5:out0",
                "@reshape_78:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Concat_2_output_0_4": {
            "name": "Concat_2_output_0",
            "op": "concat",
            "parameters": {
                "dim": 0
            },
            "inputs": [
                "@Unsqueeze_output_0_7:out0",
                "@Unsqueeze_1_output_0_8:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Add_3_output_0_5": {
            "name": "Add_3_output_0",
            "op": "add",
            "inputs": [
                "@Reshape_output_0_9:out0",
                "@reshape_81:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Unsqueeze_output_0_7": {
            "name": "Unsqueeze_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    1,
                    256,
                    4,
                    128
                ]
            },
            "inputs": [
                "@Add_1_output_0_13:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Unsqueeze_1_output_0_8": {
            "name": "Unsqueeze_1_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    1,
                    256,
                    4,
                    128
                ]
            },
            "inputs": [
                "@Reshape_3_output_0_14:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Reshape_output_0_9": {
            "name": "Reshape_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    -1,
                    3584
                ]
            },
            "inputs": [
                "@input_ids_68:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "mlp/Mul_output_0_11": {
            "name": "mlp/Mul_output_0",
            "op": "multiply",
            "parameters": {
                "axis": 1,
                "bias": false
            },
            "inputs": [
                "@mlp/act_fn/Sigmoid_output_0_26_mlp/act_fn/Mul_output_0_18:out0",
                "@reshape_84:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Add_1_output_0_13": {
            "name": "Add_1_output_0",
            "op": "add",
            "inputs": [
                "@Mul_2_output_0_20:out0",
                "@Mul_3_output_0_21:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Reshape_3_output_0_14": {
            "name": "Reshape_3_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    256,
                    4,
                    128
                ]
            },
            "inputs": [
                "@reshape_87:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Reshape_6_output_0_16": {
            "name": "Reshape_6_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    256,
                    -1
                ]
            },
            "inputs": [
                "@Transpose_3_output_0_24:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Mul_2_output_0_20": {
            "name": "Mul_2_output_0",
            "op": "multiply",
            "parameters": {
                "axis": 1,
                "bias": false
            },
            "inputs": [
                "@Reshape_2_output_0_29:out0",
                "@Gather_output_0_70:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Mul_3_output_0_21": {
            "name": "Mul_3_output_0",
            "op": "multiply",
            "parameters": {
                "axis": 1,
                "bias": false
            },
            "inputs": [
                "@Concat_1_output_0_31:out0",
                "@Gather_1_output_0_71:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Transpose_3_output_0_24": {
            "name": "Transpose_3_output_0",
            "op": "permute",
            "parameters": {
                "perm": [
                    0,
                    2,
                    1,
                    3
                ]
            },
            "inputs": [
                "@MatMul_1_output_0_35:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "post_attention_layernorm/Mul_1_output_0_27": {
            "name": "post_attention_layernorm/Mul_1_output_0",
            "op": "rmsnormalize",
            "parameters": {
                "axis_list": [
                    1
                ],
                "eps": 9.999999974752427e-07
            },
            "inputs": [
                "@post_attention_layernorm/Mul_1_output_0_27_acuity_mark_perm_72:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Reshape_2_output_0_29": {
            "name": "Reshape_2_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    256,
                    4,
                    128
                ]
            },
            "inputs": [
                "@reshape_93:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Concat_1_output_0_31": {
            "name": "Concat_1_output_0",
            "op": "concat",
            "parameters": {
                "dim": -1
            },
            "inputs": [
                "@Neg_1_output_0_43:out0",
                "@Slice_2_output_0_32:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Slice_2_output_0_32": {
            "name": "Slice_2_output_0",
            "op": "slice",
            "parameters": {
                "begin": [
                    0,
                    0,
                    0,
                    0
                ],
                "size": [
                    1,
                    256,
                    4,
                    64
                ]
            },
            "inputs": [
                "@Reshape_2_output_0_29:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "input_layernorm/Mul_1_output_0_33": {
            "name": "input_layernorm/Mul_1_output_0",
            "op": "rmsnormalize",
            "parameters": {
                "axis_list": [
                    1
                ],
                "eps": 9.999999974752427e-07
            },
            "inputs": [
                "@input_layernorm/Mul_1_output_0_33_acuity_mark_perm_73:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "MatMul_1_output_0_35": {
            "name": "MatMul_1_output_0",
            "op": "matmul",
            "parameters": {
                "transpose_a": false,
                "transpose_b": false
            },
            "inputs": [
                "@Softmax_output_0_46:out0",
                "@Reshape_5_output_0_36:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Reshape_5_output_0_36": {
            "name": "Reshape_5_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    28,
                    256,
                    128
                ]
            },
            "inputs": [
                "@Expand_1_output_0_38:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Expand_1_output_0_38": {
            "name": "Expand_1_output_0",
            "op": "expand_broadcast",
            "parameters": {
                "shape": [
                    1,
                    4,
                    7,
                    256,
                    128
                ]
            },
            "inputs": [
                "@Unsqueeze_3_output_0_39:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Unsqueeze_3_output_0_39": {
            "name": "Unsqueeze_3_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    4,
                    1,
                    256,
                    128
                ]
            },
            "inputs": [
                "@Transpose_2_output_0_40:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Transpose_2_output_0_40": {
            "name": "Transpose_2_output_0",
            "op": "permute",
            "parameters": {
                "perm": [
                    0,
                    2,
                    1,
                    3
                ]
            },
            "inputs": [
                "@Reshape_3_output_0_14:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Neg_1_output_0_43": {
            "name": "Neg_1_output_0",
            "op": "neg",
            "inputs": [
                "@Slice_3_output_0_44:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Slice_3_output_0_44": {
            "name": "Slice_3_output_0",
            "op": "slice",
            "parameters": {
                "begin": [
                    0,
                    0,
                    0,
                    64
                ],
                "size": [
                    1,
                    256,
                    4,
                    64
                ]
            },
            "inputs": [
                "@Reshape_2_output_0_29:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Softmax_output_0_46": {
            "name": "Softmax_output_0",
            "op": "softmax",
            "parameters": {
                "sf_axis": -1,
                "beta": 1.0
            },
            "inputs": [
                "@Add_2_output_0_47:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Add_2_output_0_47": {
            "name": "Add_2_output_0",
            "op": "add",
            "inputs": [
                "@Div_output_0_48:out0",
                "@attention_mask_69:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Div_output_0_48": {
            "name": "Div_output_0",
            "op": "real_div",
            "inputs": [
                "@MatMul_output_0_50:out0",
                "@Constant_32_output_0_49:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Constant_32_output_0_49": {
            "name": "Constant_32_output_0",
            "op": "variable",
            "parameters": {
                "shape": [
                    1,
                    1,
                    1,
                    1
                ],
                "is_scalar": false,
                "type": "float32"
            },
            "inputs": [],
            "outputs": [
                "out0"
            ]
        },
        "MatMul_output_0_50": {
            "name": "MatMul_output_0",
            "op": "matmul",
            "parameters": {
                "transpose_a": false,
                "transpose_b": false
            },
            "inputs": [
                "@Transpose_output_0_51:out0",
                "@Reshape_4_output_0_52:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Transpose_output_0_51": {
            "name": "Transpose_output_0",
            "op": "permute",
            "parameters": {
                "perm": [
                    0,
                    2,
                    1,
                    3
                ]
            },
            "inputs": [
                "@Add_output_0_53:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Reshape_4_output_0_52": {
            "name": "Reshape_4_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    28,
                    128,
                    256
                ]
            },
            "inputs": [
                "@Expand_output_0_54:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Add_output_0_53": {
            "name": "Add_output_0",
            "op": "add",
            "inputs": [
                "@Mul_output_0_55:out0",
                "@Mul_1_output_0_56:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Expand_output_0_54": {
            "name": "Expand_output_0",
            "op": "expand_broadcast",
            "parameters": {
                "shape": [
                    1,
                    4,
                    7,
                    128,
                    256
                ]
            },
            "inputs": [
                "@Unsqueeze_2_output_0_57:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Mul_output_0_55": {
            "name": "Mul_output_0",
            "op": "multiply",
            "parameters": {
                "axis": 1,
                "bias": false
            },
            "inputs": [
                "@Reshape_1_output_0_58:out0",
                "@Gather_output_0_70:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Mul_1_output_0_56": {
            "name": "Mul_1_output_0",
            "op": "multiply",
            "parameters": {
                "axis": 1,
                "bias": false
            },
            "inputs": [
                "@Concat_output_0_60:out0",
                "@Gather_1_output_0_71:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Unsqueeze_2_output_0_57": {
            "name": "Unsqueeze_2_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    4,
                    1,
                    128,
                    256
                ]
            },
            "inputs": [
                "@Transpose_1_output_0_62:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Reshape_1_output_0_58": {
            "name": "Reshape_1_output_0",
            "op": "reshape",
            "parameters": {
                "shape": [
                    1,
                    256,
                    28,
                    128
                ]
            },
            "inputs": [
                "@reshape_96:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Concat_output_0_60": {
            "name": "Concat_output_0",
            "op": "concat",
            "parameters": {
                "dim": -1
            },
            "inputs": [
                "@Neg_output_0_65:out0",
                "@Slice_output_0_61:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Slice_output_0_61": {
            "name": "Slice_output_0",
            "op": "slice",
            "parameters": {
                "begin": [
                    0,
                    0,
                    0,
                    0
                ],
                "size": [
                    1,
                    256,
                    28,
                    64
                ]
            },
            "inputs": [
                "@Reshape_1_output_0_58:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Transpose_1_output_0_62": {
            "name": "Transpose_1_output_0",
            "op": "permute",
            "parameters": {
                "perm": [
                    0,
                    2,
                    3,
                    1
                ]
            },
            "inputs": [
                "@Add_1_output_0_13:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Neg_output_0_65": {
            "name": "Neg_output_0",
            "op": "neg",
            "inputs": [
                "@Slice_1_output_0_66:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "Slice_1_output_0_66": {
            "name": "Slice_1_output_0",
            "op": "slice",
            "parameters": {
                "begin": [
                    0,
                    0,
                    0,
                    64
                ],
                "size": [
                    1,
                    256,
                    28,
                    64
                ]
            },
            "inputs": [
                "@Reshape_1_output_0_58:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "input_ids_68": {
            "name": "input_ids",
            "op": "input",
            "parameters": {
                "size": "",
                "channels": 1,
                "shape": [
                    256,
                    1,
                    3584
                ],
                "is_scalar": false,
                "type": "float32"
            },
            "inputs": [],
            "outputs": [
                "out0"
            ]
        },
        "attention_mask_69": {
            "name": "attention_mask",
            "op": "input",
            "parameters": {
                "size": "",
                "channels": 1,
                "shape": [
                    1,
                    1,
                    256,
                    256
                ],
                "is_scalar": false,
                "type": "float32"
            },
            "inputs": [],
            "outputs": [
                "out0"
            ]
        },
        "Gather_output_0_70": {
            "name": "Gather_output_0",
            "op": "input",
            "parameters": {
                "size": "",
                "channels": 1,
                "shape": [
                    1,
                    256,
                    1,
                    128
                ],
                "is_scalar": false,
                "type": "float32"
            },
            "inputs": [],
            "outputs": [
                "out0"
            ]
        },
        "Gather_1_output_0_71": {
            "name": "Gather_1_output_0",
            "op": "input",
            "parameters": {
                "size": "",
                "channels": 1,
                "shape": [
                    1,
                    256,
                    1,
                    128
                ],
                "is_scalar": false,
                "type": "float32"
            },
            "inputs": [],
            "outputs": [
                "out0"
            ]
        },
        "post_attention_layernorm/Mul_1_output_0_27_acuity_mark_perm_72": {
            "name": "post_attention_layernorm/Mul_1_output_0_27_acuity_mark_perm",
            "op": "permute",
            "parameters": {
                "perm": [
                    0,
                    2,
                    1
                ]
            },
            "inputs": [
                "@Add_3_output_0_5:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "input_layernorm/Mul_1_output_0_33_acuity_mark_perm_73": {
            "name": "input_layernorm/Mul_1_output_0_33_acuity_mark_perm",
            "op": "permute",
            "parameters": {
                "perm": [
                    0,
                    2,
                    1
                ]
            },
            "inputs": [
                "@Reshape_output_0_9:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "post_attention_layernorm/Mul_1_output_0_27_acuity_mark_perm_74": {
            "name": "post_attention_layernorm/Mul_1_output_0_27_acuity_mark_perm",
            "op": "permute",
            "parameters": {
                "perm": [
                    0,
                    2,
                    1
                ]
            },
            "inputs": [
                "@post_attention_layernorm/Mul_1_output_0_27:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "input_layernorm/Mul_1_output_0_33_acuity_mark_perm_75": {
            "name": "input_layernorm/Mul_1_output_0_33_acuity_mark_perm",
            "op": "permute",
            "parameters": {
                "perm": [
                    0,
                    2,
                    1
                ]
            },
            "inputs": [
                "@input_layernorm/Mul_1_output_0_33:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_76": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    18944
                ]
            },
            "inputs": [
                "@mlp/Mul_output_0_11:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "fullconnect_77": {
            "name": "fullconnect",
            "op": "fullconnect",
            "parameters": {
                "weights": 3584,
                "bias": true,
                "regularize": false,
                "axis": 1
            },
            "inputs": [
                "@reshape_76:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_78": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    256,
                    3584
                ]
            },
            "inputs": [
                "@fullconnect_77:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_79": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    3584
                ]
            },
            "inputs": [
                "@Reshape_6_output_0_16:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "fullconnect_80": {
            "name": "fullconnect",
            "op": "fullconnect",
            "parameters": {
                "weights": 3584,
                "bias": true,
                "regularize": false,
                "axis": 1
            },
            "inputs": [
                "@reshape_79:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_81": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    256,
                    3584
                ]
            },
            "inputs": [
                "@fullconnect_80:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_82": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    3584
                ]
            },
            "inputs": [
                "@post_attention_layernorm/Mul_1_output_0_27_acuity_mark_perm_74:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "fullconnect_83": {
            "name": "fullconnect",
            "op": "fullconnect",
            "parameters": {
                "weights": 18944,
                "bias": true,
                "regularize": false,
                "axis": 1
            },
            "inputs": [
                "@reshape_82:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_84": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    256,
                    18944
                ]
            },
            "inputs": [
                "@fullconnect_83:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_85": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    3584
                ]
            },
            "inputs": [
                "@input_layernorm/Mul_1_output_0_33_acuity_mark_perm_75:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "fullconnect_86": {
            "name": "fullconnect",
            "op": "fullconnect",
            "parameters": {
                "weights": 512,
                "bias": true,
                "regularize": false,
                "axis": 1
            },
            "inputs": [
                "@reshape_85:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_87": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    256,
                    512
                ]
            },
            "inputs": [
                "@fullconnect_86:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_88": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    3584
                ]
            },
            "inputs": [
                "@post_attention_layernorm/Mul_1_output_0_27_acuity_mark_perm_74:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "fullconnect_89": {
            "name": "fullconnect",
            "op": "fullconnect",
            "parameters": {
                "weights": 18944,
                "bias": true,
                "regularize": false,
                "axis": 1
            },
            "inputs": [
                "@reshape_88:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_90": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    256,
                    18944
                ]
            },
            "inputs": [
                "@fullconnect_89:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_91": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    3584
                ]
            },
            "inputs": [
                "@input_layernorm/Mul_1_output_0_33_acuity_mark_perm_75:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "fullconnect_92": {
            "name": "fullconnect",
            "op": "fullconnect",
            "parameters": {
                "weights": 512,
                "bias": true,
                "regularize": false,
                "axis": 1
            },
            "inputs": [
                "@reshape_91:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_93": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    256,
                    512
                ]
            },
            "inputs": [
                "@fullconnect_92:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_94": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    3584
                ]
            },
            "inputs": [
                "@input_layernorm/Mul_1_output_0_33_acuity_mark_perm_75:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "fullconnect_95": {
            "name": "fullconnect",
            "op": "fullconnect",
            "parameters": {
                "weights": 3584,
                "bias": true,
                "regularize": false,
                "axis": 1
            },
            "inputs": [
                "@reshape_94:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "reshape_96": {
            "name": "reshape",
            "op": "reshape",
            "parameters": {
                "shape": [
                    -1,
                    256,
                    3584
                ]
            },
            "inputs": [
                "@fullconnect_95:out0"
            ],
            "outputs": [
                "out0"
            ]
        },
        "mlp/act_fn/Sigmoid_output_0_26_mlp/act_fn/Mul_output_0_18": {
            "name": "swish",
            "op": "swish",
            "parameters": {
                "beta": 1.0
            },
            "inputs": [
                "@reshape_90:out0"
            ],
            "outputs": [
                "out0"
            ]
        }
    },
    "quantize_info": {}
}